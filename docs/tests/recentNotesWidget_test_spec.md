# RecentNotesWidget テスト仕様書

## 概要
- 対象: `src/widgets/recent-notes/index.ts` `RecentNotesWidget`
- 目的: 最近編集したノートウィジェットのUI・リスト表示・設定反映の仕様検証

---

## テストケース一覧

| No. | テスト内容                                 | 目的                                 | 結果 | 備考 |
|-----|--------------------------------------------|--------------------------------------|------|------|
| 1   | DOM構造・リスト生成                        | UI要素の生成・初期化                 |      |      |
| 2   | ノートなし時のメッセージ表示               | ノートがない場合のUI                 |      |      |
| 3   | ノートリストのmtime降順描画                | 並び順・内容の正しさ                 |      |      |
| 4   | ノート名クリックでopenLinkText呼び出し      | ノートリンク動作                     |      |      |
| 5   | maxNotes設定で表示件数制限                 | 設定反映・リスト件数                  |      |      |
| 6   | updateExternalSettingsでmaxNotes反映        | 外部設定変更の反映                    |      |      |
| 7   | 設定値のバリデーション                      | 不正な設定値が与えられた場合の挙動を確認 |      |      |
| 8   | フィルタリング機能                          | ファイル種別による表示制御の確認       |      |      |
| 9   | メモリ管理                                  | リソース解放の確認                     |      |      |
| 10  | 他のウィジェットとの連携                    | ウィジェット間の相互作用の確認         |      |      |
| 11  | パフォーマンス                              | 大量データ・高頻度更新時の動作確認     |      |      |
| 12  | エラー処理                                  | 異常系での動作確認                       |      |      |
| 13  | アクセシビリティ                            | キーボード操作・スクリーンリーダー対応の確認 |      |      |
| 14  | 国際化対応                                  | 多言語環境での動作確認                     |      |      |

---

## 各テストケース詳細

### 1. DOM構造・リスト生成
- **テスト対象**: `RecentNotesWidget.create`
- **目的**: recent-notes-widgetクラスやリストが正しく生成されるか
- **前提条件**: ダミーconfig/app/pluginを用意
- **入力値・操作**: `widget.create(config, app, plugin)`
- **期待結果**: recent-notes-widgetクラスとrecent-notes-listがDOM上に存在する
- **手順**:
  1. ダミーconfig/app/pluginを用意
  2. createを呼び出す
  3. DOMを検証
- **実施結果記録**:

---

### 2. ノートなし時のメッセージ表示
- **テスト対象**: `RecentNotesWidget.create`, `renderNotesList`
- **目的**: ノートが存在しない場合に「最近編集したノートがありません」と表示されるか
- **前提条件**: getFilesが空配列を返すようにモック
- **入力値・操作**: create後、textContentを確認
- **期待結果**: 「最近編集したノートがありません」と表示される
- **手順**:
  1. getFilesを空配列返却にモック
  2. create呼び出し
  3. textContentを検証
- **実施結果記録**:

---

### 3. ノートリストのmtime降順描画
- **テスト対象**: `RecentNotesWidget.create`, `renderNotesList`
- **目的**: ノートリストがmtime降順で正しく描画されるか
- **前提条件**: getFilesで複数ノートを返す
- **入力値・操作**: create後、recent-note-itemの順序を確認
- **期待結果**: mtimeが大きい順に並ぶ
- **手順**:
  1. getFilesで複数ノートを返す
  2. create呼び出し
  3. recent-note-itemの順序を検証
- **実施結果記録**:

---

### 4. ノート名クリックでopenLinkText呼び出し
- **テスト対象**: ノートリンクのクリックイベント
- **目的**: ノート名クリックでopenLinkTextが正しい引数で呼ばれるか
- **前提条件**: ケース3と同じ
- **入力値・操作**: ノート名リンクをクリック
- **期待結果**: openLinkTextが正しい引数で呼ばれる
- **手順**:
  1. create呼び出し
  2. ノート名リンクをクリック
  3. openLinkTextの呼び出しを検証
- **実施結果記録**:

---

### 5. maxNotes設定で表示件数制限
- **テスト対象**: `RecentNotesWidget.create`, `renderNotesList`
- **目的**: maxNotes設定でリスト件数が制限されるか
- **前提条件**: getFilesで複数ノートを返す
- **入力値・操作**: maxNotesを1に設定しcreate呼び出し
- **期待結果**: recent-note-itemの件数が1になる
- **手順**:
  1. maxNotes=1に設定
  2. create呼び出し
  3. recent-note-itemの件数を検証
- **実施結果記録**:

---

### 6. updateExternalSettingsでmaxNotes反映
- **テスト対象**: `RecentNotesWidget.updateExternalSettings`
- **目的**: updateExternalSettingsでmaxNotesが反映されるか
- **前提条件**: ケース5と同じ
- **入力値・操作**: updateExternalSettingsでmaxNotesを1に変更
- **期待結果**: currentSettings.maxNotesが1、recent-note-itemの件数が1
- **手順**:
  1. create呼び出し
  2. updateExternalSettingsでmaxNotes=1に変更
  3. currentSettings.maxNotesとrecent-note-itemの件数を検証
- **実施結果記録**:

---

### 7. 設定値のバリデーション
- **テスト対象**: `RecentNotesWidget.create`, `updateExternalSettings`
- **目的**: 不正な設定値が与えられた場合の挙動を確認
- **前提条件**: 不正な設定値（負数、0など）
- **入力値・操作**: 
  1. maxNotesに負数を設定
  2. maxNotesに0を設定
- **期待結果**: 
  - 負数の場合はデフォルト値が使用される
  - 0の場合はすべてのノートが表示される
- **手順**:
  1. 不正な設定値でcreate呼び出し
  2. 設定値とリスト表示を検証
- **実施結果記録**:

---

### 8. フィルタリング機能
- **テスト対象**: `RecentNotesWidget.create`, `renderNotesList`
- **目的**: ファイル種別による表示制御の確認
- **前提条件**: 
  - .md以外の拡張子のファイルを含む
  - 除外パターンに一致するファイル名を含む
- **入力値・操作**: 
  1. 複数の拡張子のファイルでcreate呼び出し
  2. 除外パターンに一致するファイルでcreate呼び出し
- **期待結果**: 
  - .md以外のファイルは表示されない
  - 除外パターンに一致するファイルは表示されない
- **実施結果記録**:

---

### 9. メモリ管理
- **テスト対象**: `RecentNotesWidget.onunload`
- **目的**: リソース解放の確認
- **前提条件**: イベントリスナーが設定された状態
- **入力値・操作**: onunload呼び出し
- **期待結果**: すべてのイベントリスナーが解除される
- **手順**:
  1. ウィジェット作成
  2. onunload呼び出し
  3. イベントリスナー解除を検証
- **実施結果記録**:

---

### 10. 他のウィジェットとの連携
- **テスト対象**: `RecentNotesWidget` と他ウィジェットの連携
- **目的**: ウィジェット間の相互作用の確認
- **前提条件**: 
  - メモウィジェットが有効
  - ファイルビューアウィジェットが有効
- **入力値・操作**:
  1. メモウィジェットでノート作成
  2. ファイルビューアでノート表示
- **期待結果**: 
  - 新規作成したノートが最近のノートに表示される
  - 表示したノートが最近のノートに反映される
- **実施結果記録**:

---

### 11. パフォーマンス
- **テスト対象**: `RecentNotesWidget.create`, `renderNotesList`
- **目的**: 大量データ・高頻度更新時の動作確認
- **前提条件**: 
  - 1000件以上のノート
  - 頻繁な更新が発生する環境
- **入力値・操作**:
  1. 大量ノートでの表示
  2. 高頻度更新のシミュレーション
- **期待結果**: 
  - 表示が破綻しない
  - パフォーマンスが著しく低下しない
- **実施結果記録**:

---

### 12. エラー処理
- **テスト対象**: `RecentNotesWidget` のエラーハンドリング
- **目的**: 異常系での動作確認
- **前提条件**: 
  - ファイルシステムエラー
  - 破損したメタデータ
- **入力値・操作**:
  1. FSエラーの発生
  2. 破損メタデータの読み込み
- **期待結果**: 
  - 適切なエラーメッセージが表示される
  - 動作を継続できる
- **実施結果記録**:

---

### 13. アクセシビリティ
- **テスト対象**: `RecentNotesWidget` のアクセシビリティ対応
- **目的**: キーボード操作・スクリーンリーダー対応の確認
- **前提条件**: なし
- **入力値・操作**:
  1. キーボードでの操作
  2. スクリーンリーダーでの読み上げ
- **期待結果**: 
  - キーボードで全機能にアクセス可能
  - ARIA属性が適切に設定されている
- **実施結果記録**:

---

### 14. 国際化対応
- **テスト対象**: `RecentNotesWidget` の多言語対応
- **目的**: 多言語環境での動作確認
- **前提条件**: 
  - 日本語ファイル名のノート
  - RTL言語設定
- **入力値・操作**:
  1. 日本語ファイル名の表示
  2. RTLレイアウトでの表示
- **期待結果**: 
  - 日本語が正しく表示される
  - RTLでレイアウトが崩れない
- **実施結果記録**:

---

## 進捗・メモ

- [ ] ケース1 実施済み
- [ ] ケース2 未実施
- [ ] ケース3 未実施
- [ ] ケース4 未実施
- [ ] ケース5 未実施
- [ ] ケース6 未実施
- [ ] ケース7 未実施
- [ ] ケース8 未実施
- [ ] ケース9 未実施
- [ ] ケース10 未実施
- [ ] ケース11 未実施
- [ ] ケース12 未実施
- [ ] ケース13 未実施
- [ ] ケース14 未実施 