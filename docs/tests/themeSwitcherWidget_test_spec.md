# ThemeSwitcherWidget テスト仕様書

## 概要
- 対象: `src/widgets/theme-switcher/index.ts` `ThemeSwitcherWidget`
- 目的: テーマ切替ウィジェットのUI・テーマ切替・異常系・設定反映の仕様検証

---

## テストレベル別テストケース一覧

### 1. 単体テスト（Unit Test）
| No. | テスト内容                                         | 目的                                 |
|-----|----------------------------------------------------|--------------------------------------|
| U1  | DOM構造・クラス・タイトルの付与                    | UI要素・タイトルの正しい表示         |
| U2  | テーマ一覧の描画                                   | テーマリストが正しく表示される       |
| U3  | テーマ一覧が空の場合の表示                         | デフォルトのみ表示される             |
| U4  | customCss未定義時のエラーメッセージ                 | API未提供時の異常系                  |
| U5  | themesがobject型でもリスト化される                  | 柔軟なテーマリスト取得               |

### 2. 統合テスト（Integration Test）
| No. | テスト内容                                         | 目的                                 |
|-----|----------------------------------------------------|--------------------------------------|
| I1  | テーマ切替時のsetTheme/Notice/activeクラス切替      | テーマ切替の副作用・UI反映           |
| I2  | applyWidgetSizeが呼ばれる（設定反映）               | 設定値のUI反映                       |

### 3. システムテスト（System Test）
| No. | テスト内容                                         | 目的                                 |
|-----|----------------------------------------------------|--------------------------------------|
| S1  | 複数ウィジェットと同時に動作し、テーマ切替が全体に反映される | ボード全体でのテーマ切替             |

### 4. ユーザー受け入れテスト（UAT）
| No. | テスト内容                                         | 目的                                 |
|-----|----------------------------------------------------|--------------------------------------|
| A1  | ユーザーがテーマを選択すると即座にテーマが切り替わり通知が表示される | UX観点・即時反映                     |
| A2  | テーマ一覧が空の場合でも「デフォルト」だけが選択肢として表示される | UX観点・空リスト時の動作             |
| A3  | テーマ切替APIが利用できない場合、ユーザーに分かりやすいエラーメッセージが表示される | UX観点・異常系                       |
| A4  | 既に適用済みのテーマを選択した場合、「すでにこのテーマが適用されています」と通知される | UX観点・二重適用時の通知             |

---

## 各テストケース詳細

### 単体テスト（Unit Test）
#### U1. DOM構造・クラス・タイトルの付与
- **手順**: ダミーconfig/app/pluginでcreateを呼び出し、DOM構造・タイトルを検証
- **期待結果**: .theme-switcher-widgetクラスとタイトルが表示される

#### U2. テーマ一覧の描画
- **手順**: customCss.themesに複数テーマを設定しcreate呼び出し、リスト要素数を検証
- **期待結果**: .theme-switcher-itemが複数生成される

#### U3. テーマ一覧が空の場合の表示
- **手順**: customCss.themes = []でcreate呼び出し、リスト要素数・内容を検証
- **期待結果**: デフォルトのみリスト表示

#### U4. customCss未定義時のエラーメッセージ
- **手順**: app.customCss未定義でcreate呼び出し、メッセージ表示を検証
- **期待結果**: 「テーマ切り替えAPIが利用できません。」の表示

#### U5. themesがobject型でもリスト化される
- **手順**: customCss.themesをobject型で設定しcreate呼び出し、リスト内容を検証
- **期待結果**: dracula/solarized等がリストに含まれる

### 統合テスト（Integration Test）
#### I1. テーマ切替時のsetTheme/Notice/activeクラス切替
- **手順**: テーマリストのliをクリックしsetTheme/Notice/activeクラスを検証
- **期待結果**: setTheme/Notice/activeクラスが正しく動作

#### I2. applyWidgetSizeが呼ばれる（設定反映）
- **手順**: spyOnでapplyWidgetSizeを監視しcreate呼び出し、呼び出し有無を検証
- **期待結果**: applyWidgetSizeが呼ばれる

### システムテスト（System Test）
#### S1. 複数ウィジェットと同時に動作し、テーマ切替が全体に反映される
- **手順**: 2つのThemeSwitcherWidgetを作成し、片方でテーマ切替→両方のUI/状態を検証
- **期待結果**: 両方のウィジェットでテーマが切り替わる

### ユーザー受け入れテスト（UAT）
#### A1. ユーザーがテーマを選択すると即座にテーマが切り替わり通知が表示される
- **手順**: ユーザー操作を模擬し、テーマ選択→通知・UI反映を検証
- **期待結果**: テーマが即時切り替わり、通知が表示される

#### A2. テーマ一覧が空の場合でも「デフォルト」だけが選択肢として表示される
- **手順**: themes空でcreate呼び出し、リスト内容を検証
- **期待結果**: デフォルトのみ表示

#### A3. テーマ切替APIが利用できない場合、ユーザーに分かりやすいエラーメッセージが表示される
- **手順**: customCss未定義でcreate呼び出し、エラーメッセージを検証
- **期待結果**: エラーメッセージ表示

#### A4. 既に適用済みのテーマを選択した場合、「すでにこのテーマが適用されています」と通知される
- **手順**: activeなliをクリックし、通知内容を検証
- **期待結果**: 「すでにこのテーマが適用されています。」の通知

---

## 進捗・メモ

- [ ] U1 実施済み
- [ ] U2 実施済み
- [ ] U3 実施済み
- [ ] U4 実施済み
- [ ] U5 実施済み
- [ ] I1 実施済み
- [ ] I2 実施済み
- [ ] S1 実施済み
- [ ] A1 実施済み
- [ ] A2 実施済み
- [ ] A3 実施済み
- [ ] A4 実施済み 